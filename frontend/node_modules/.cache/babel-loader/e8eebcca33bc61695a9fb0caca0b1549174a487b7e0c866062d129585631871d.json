{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useReducer, useEffect } from 'react';\nfunction reducer(state, action) {\n  switch (action.type) {\n    case 'LOADING':\n      return {\n        isLoading: true,\n        data: null,\n        error: null\n      };\n    case 'SUCCESS':\n      return {\n        isLoading: false,\n        data: action.data,\n        error: null\n      };\n    case 'ERROR':\n      return {\n        isLoading: false,\n        data: null,\n        error: action.error\n      };\n    default:\n      return state;\n  }\n}\nfunction useAsync(callback, deps = [], skip = false) {\n  _s();\n  const initialState = {\n    isLoading: false,\n    data: null,\n    error: null\n  };\n  const [state, dispatch] = useReducer(reducer, initialState);\n  useEffect(() => {\n    let isCancelled = false; // 취소 플래그\n\n    const fetchData = async () => {\n      console.log('Fetch Data 시작'); // 시작 로그\n      dispatch({\n        type: 'LOADING'\n      });\n      try {\n        const response = await callback();\n        if (!isCancelled) {\n          console.log('Fetch Data 성공', response.data); // 성공 로그\n          dispatch({\n            type: 'SUCCESS',\n            data: response.data\n          });\n        } else {\n          console.log('Fetch Data 취소됨'); // 취소 로그\n        }\n      } catch (e) {\n        if (!isCancelled) {\n          console.log('Fetch Data 실패', e); // 실패 로그\n          dispatch({\n            type: 'ERROR',\n            error: e\n          });\n        } else {\n          console.log('Fetch Data 취소됨'); // 취소 로그\n        }\n      }\n    };\n\n    if (!skip) {\n      fetchData();\n    }\n    return () => {\n      isCancelled = true; // 클린업 시 취소 플래그 설정\n      console.log('Cleanup 실행됨'); // 클린업 로그\n    };\n  }, deps);\n  const {\n    isLoading,\n    data,\n    error\n  } = state;\n  const refetch = async () => {\n    const isCancelled = false;\n    dispatch({\n      type: 'LOADING'\n    });\n    try {\n      const response = await callback();\n      if (!isCancelled) {\n        dispatch({\n          type: 'SUCCESS',\n          data: response.data\n        });\n      }\n    } catch (e) {\n      if (!isCancelled) {\n        dispatch({\n          type: 'ERROR',\n          error: e\n        });\n      }\n    }\n  };\n  return () => {\n    isCancelled = true;\n  };\n  return {\n    isLoading,\n    data: data,\n    error,\n    refetch\n  };\n}\n_s(useAsync, \"bgCdjuTOmPdSBRwTap80EFd9Y3U=\");\nexport default useAsync;","map":{"version":3,"names":["useReducer","useEffect","reducer","state","action","type","isLoading","data","error","useAsync","callback","deps","skip","_s","initialState","dispatch","isCancelled","fetchData","console","log","response","e","refetch"],"sources":["/Users/sarang_daddy/Documents/second-hand/frontend/src/hooks/useAsync.ts"],"sourcesContent":["import { useReducer, useEffect, DependencyList } from 'react';\nimport { AxiosResponse, AxiosError } from 'axios';\n\ninterface State<T> {\n  isLoading: boolean;\n  data: T | null;\n  error: AxiosError | null;\n}\n\ntype Action<T> =\n  | { type: 'LOADING' }\n  | { type: 'SUCCESS'; data: T }\n  | { type: 'ERROR'; error: AxiosError };\n\nfunction reducer<T>(state: State<T>, action: Action<T>): State<T> {\n  switch (action.type) {\n    case 'LOADING':\n      return {\n        isLoading: true,\n        data: null,\n        error: null,\n      };\n    case 'SUCCESS':\n      return {\n        isLoading: false,\n        data: action.data,\n        error: null,\n      };\n    case 'ERROR':\n      return {\n        isLoading: false,\n        data: null,\n        error: action.error,\n      };\n    default:\n      return state;\n  }\n}\n\nfunction useAsync<T>(\n  callback: () => Promise<AxiosResponse<T>>,\n  deps: DependencyList = [],\n  skip = false,\n): {\n  isLoading: boolean;\n  data: T | null;\n  error: AxiosError | null;\n  refetch: () => Promise<void>;\n} {\n  const initialState: State<T> = {\n    isLoading: false,\n    data: null,\n    error: null,\n  };\n\n  const [state, dispatch] = useReducer(reducer, initialState);\n\n  useEffect(() => {\n    let isCancelled = false; // 취소 플래그\n\n    const fetchData = async () => {\n      console.log('Fetch Data 시작'); // 시작 로그\n      dispatch({ type: 'LOADING' });\n      try {\n        const response: AxiosResponse<T> = await callback();\n        if (!isCancelled) {\n          console.log('Fetch Data 성공', response.data); // 성공 로그\n          dispatch({ type: 'SUCCESS', data: response.data });\n        } else {\n          console.log('Fetch Data 취소됨'); // 취소 로그\n        }\n      } catch (e) {\n        if (!isCancelled) {\n          console.log('Fetch Data 실패', e); // 실패 로그\n          dispatch({ type: 'ERROR', error: e as AxiosError });\n        } else {\n          console.log('Fetch Data 취소됨'); // 취소 로그\n        }\n      }\n    };\n\n    if (!skip) {\n      fetchData();\n    }\n\n    return () => {\n      isCancelled = true; // 클린업 시 취소 플래그 설정\n      console.log('Cleanup 실행됨'); // 클린업 로그\n    };\n  }, deps);\n\n  const { isLoading, data, error } = state;\n\n  const refetch = async () => {\n    const isCancelled = false;\n    dispatch({ type: 'LOADING' });\n    try {\n      const response: AxiosResponse<T> = await callback();\n      if (!isCancelled) {\n        dispatch({ type: 'SUCCESS', data: response.data });\n      }\n    } catch (e) {\n      if (!isCancelled) {\n        dispatch({ type: 'ERROR', error: e as AxiosError });\n      }\n    }\n  };\n  return () => {\n    isCancelled = true;\n  };\n\n  return { isLoading, data: data as T, error, refetch };\n}\n\nexport default useAsync;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}