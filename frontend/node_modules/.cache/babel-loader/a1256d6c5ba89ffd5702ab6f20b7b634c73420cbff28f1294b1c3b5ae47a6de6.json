{"ast":null,"code":"var _jsxFileName = \"/Users/sarang_daddy/Documents/second-hand/frontend/src/components/UploadPhoto/index.tsx\",\n  _s = $RefreshSig$();\nimport { useState, useRef, useContext } from 'react';\nimport { postSalesItemContext } from '../../context/SalesItem/useContext';\nimport * as S from './styles';\nimport Icon from '../Icon';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n// TODO : 최대 업로드 사진 수 제한 주기\n\nconst UploadPhoto = () => {\n  _s();\n  const maxImageCount = 10;\n  const fileInputRef = useRef(null);\n  const {\n    setPostObject\n  } = useContext(postSalesItemContext);\n  const [uploadedCount, setUploadedCount] = useState(0);\n  const [uploadedImages, setUploadedImages] = useState([]);\n  const handleDeleteBtnClick = id => {\n    setUploadedImages(prevImages => prevImages.filter(image => image.id !== id));\n    setUploadedCount(prevCount => prevCount - 1);\n    setPostObject(prevPostObject => {\n      const updatedFiles = prevPostObject.files ? prevPostObject.files.filter((_, index) => index !== uploadedImages.findIndex(image => image.id === id)) : null;\n      return {\n        ...prevPostObject,\n        files: updatedFiles\n      };\n    });\n  };\n  const handleUploadImage = event => {\n    var _event$target$files;\n    const file = (_event$target$files = event.target.files) === null || _event$target$files === void 0 ? void 0 : _event$target$files[0];\n    console.log(event.target.files);\n    console.log(file);\n    if (file) {\n      const imageUrl = URL.createObjectURL(file);\n      const isDuplicate = uploadedImages.some(image => image.file.name === file.name && image.file.size === file.size);\n      if (isDuplicate) {\n        event.target.value = '';\n        return;\n      }\n      const newUploadedImage = {\n        id: Date.now().toString(),\n        imageUrl,\n        file\n      };\n      setUploadedImages(prevImages => [...prevImages, newUploadedImage]);\n      setUploadedCount(prevCount => prevCount + 1);\n      const formData = new FormData();\n      formData.append('productImageUrls', file);\n      setPostObject(prevPostObject => ({\n        ...prevPostObject,\n        files: [...(prevPostObject.files || []), formData]\n      }));\n    }\n    event.target.value = '';\n  };\n  const handleUploadIconClick = () => {\n    var _fileInputRef$current;\n    (_fileInputRef$current = fileInputRef.current) === null || _fileInputRef$current === void 0 ? void 0 : _fileInputRef$current.click();\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(S.UploadPhotoContainer, {\n      children: [/*#__PURE__*/_jsxDEV(S.UploadIcon, {\n        onClick: handleUploadIconClick,\n        children: [/*#__PURE__*/_jsxDEV(Icon, {\n          name: \"camera\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [uploadedCount, \" / \", maxImageCount]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(S.UploadInput, {\n          type: \"file\",\n          accept: \"image/*\",\n          onChange: handleUploadImage,\n          ref: fileInputRef\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(S.Photos, {\n        children: uploadedImages.map(image => /*#__PURE__*/_jsxDEV(S.PhotoElement, {\n          children: [/*#__PURE__*/_jsxDEV(S.Photo, {\n            src: image.imageUrl\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(S.DeleteBtn, {\n            onClick: () => handleDeleteBtnClick(image.id),\n            children: /*#__PURE__*/_jsxDEV(Icon, {\n              name: \"x\",\n              width: \"20\",\n              height: \"20\",\n              fill: \"white\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 108,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 15\n          }, this)]\n        }, image.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n};\n_s(UploadPhoto, \"WVwMozMC9l0q6gZtZkf8v1yp+wI=\");\n_c = UploadPhoto;\nexport default UploadPhoto;\nvar _c;\n$RefreshReg$(_c, \"UploadPhoto\");","map":{"version":3,"names":["useState","useRef","useContext","postSalesItemContext","S","Icon","jsxDEV","_jsxDEV","Fragment","_Fragment","UploadPhoto","_s","maxImageCount","fileInputRef","setPostObject","uploadedCount","setUploadedCount","uploadedImages","setUploadedImages","handleDeleteBtnClick","id","prevImages","filter","image","prevCount","prevPostObject","updatedFiles","files","_","index","findIndex","handleUploadImage","event","_event$target$files","file","target","console","log","imageUrl","URL","createObjectURL","isDuplicate","some","name","size","value","newUploadedImage","Date","now","toString","formData","FormData","append","handleUploadIconClick","_fileInputRef$current","current","click","children","UploadPhotoContainer","UploadIcon","onClick","fileName","_jsxFileName","lineNumber","columnNumber","UploadInput","type","accept","onChange","ref","Photos","map","PhotoElement","Photo","src","DeleteBtn","width","height","fill","_c","$RefreshReg$"],"sources":["/Users/sarang_daddy/Documents/second-hand/frontend/src/components/UploadPhoto/index.tsx"],"sourcesContent":["import { useState, ChangeEvent, useRef, useContext } from 'react';\n\nimport {\n  postSalesItemContext,\n  PostObjectType,\n} from '../../context/SalesItem/useContext';\nimport * as S from './styles';\nimport Icon from '../Icon';\n\ninterface UploadedImageType {\n  id: string;\n  imageUrl: string;\n  file: File;\n}\n\n// TODO : 최대 업로드 사진 수 제한 주기\n\nconst UploadPhoto = () => {\n  const maxImageCount = 10;\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const { setPostObject } = useContext(postSalesItemContext);\n  const [uploadedCount, setUploadedCount] = useState<number>(0);\n  const [uploadedImages, setUploadedImages] = useState<UploadedImageType[]>([]);\n\n  const handleDeleteBtnClick = (id: string) => {\n    setUploadedImages((prevImages) =>\n      prevImages.filter((image) => image.id !== id),\n    );\n    setUploadedCount((prevCount) => prevCount - 1);\n\n    setPostObject((prevPostObject: PostObjectType) => {\n      const updatedFiles = prevPostObject.files\n        ? prevPostObject.files.filter(\n            (_, index) =>\n              index !== uploadedImages.findIndex((image) => image.id === id),\n          )\n        : null;\n\n      return {\n        ...prevPostObject,\n        files: updatedFiles,\n      };\n    });\n  };\n\n  const handleUploadImage = (event: ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n\n    console.log(event.target.files);\n    console.log(file);\n\n    if (file) {\n      const imageUrl = URL.createObjectURL(file);\n      const isDuplicate = uploadedImages.some(\n        (image) =>\n          image.file.name === file.name && image.file.size === file.size,\n      );\n\n      if (isDuplicate) {\n        event.target.value = '';\n        return;\n      }\n\n      const newUploadedImage: UploadedImageType = {\n        id: Date.now().toString(),\n        imageUrl,\n        file,\n      };\n\n      setUploadedImages((prevImages) => [...prevImages, newUploadedImage]);\n      setUploadedCount((prevCount) => prevCount + 1);\n\n      const formData = new FormData();\n      formData.append('productImageUrls', file);\n\n      setPostObject((prevPostObject: PostObjectType) => ({\n        ...prevPostObject,\n        files: [...(prevPostObject.files || []), formData],\n      }));\n    }\n    event.target.value = '';\n  };\n\n  const handleUploadIconClick = () => {\n    fileInputRef.current?.click();\n  };\n\n  return (\n    <>\n      <S.UploadPhotoContainer>\n        <S.UploadIcon onClick={handleUploadIconClick}>\n          <Icon name=\"camera\" />\n          <span>\n            {uploadedCount} / {maxImageCount}\n          </span>\n          <S.UploadInput\n            type=\"file\"\n            accept=\"image/*\"\n            onChange={handleUploadImage}\n            ref={fileInputRef}\n          />\n        </S.UploadIcon>\n        <S.Photos>\n          {uploadedImages.map((image) => (\n            <S.PhotoElement key={image.id}>\n              <S.Photo src={image.imageUrl} />\n              <S.DeleteBtn onClick={() => handleDeleteBtnClick(image.id)}>\n                <Icon name=\"x\" width=\"20\" height=\"20\" fill=\"white\" />\n              </S.DeleteBtn>\n            </S.PhotoElement>\n          ))}\n        </S.Photos>\n      </S.UploadPhotoContainer>\n    </>\n  );\n};\n\nexport default UploadPhoto;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}