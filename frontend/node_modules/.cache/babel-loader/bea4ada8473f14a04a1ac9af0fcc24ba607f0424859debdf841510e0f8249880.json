{"ast":null,"code":"var _jsxFileName = \"/Users/sarang_daddy/Documents/second-hand/frontend/src/pages/SalesMyItem/index.tsx\",\n  _s = $RefreshSig$();\nimport { useNavigate } from 'react-router-dom';\nimport { useEffect, useState } from 'react';\nimport { postProducts } from '../../api/product';\nimport { ACCESS_TOKEN } from '../../constants/login';\nimport { postSalesItemContext } from '../../context/SalesItem/useContext';\nimport * as S from './styles';\nimport NavBarTitle from '../../components/NavBarTitle';\nimport UploadPhoto from '../../components/UploadPhoto';\nimport UploadTitle from '../../components/UploadTitle';\nimport UploadPrice from '../../components/UploadPrice';\nimport UploadComment from '../../components/UploadComment';\nimport UploadLocation from '../../components/UploadLocation';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst SalesMyItemPage = () => {\n  _s();\n  const accessToken = localStorage.getItem(ACCESS_TOKEN);\n  const navigation = useNavigate();\n  const initialPostObject = {\n    title: null,\n    price: null,\n    content: null,\n    categoryId: null,\n    locationId: null,\n    files: null\n  };\n  const [postObject, setPostObject] = useState(initialPostObject);\n  const [isUploadCompleteEnabled, setIsUploadCompleteEnabled] = useState(false);\n  const storedPostObject = localStorage.getItem('postObject');\n  if (storedPostObject && storedPostObject !== JSON.stringify(postObject)) {\n    console.log('Loaded postObject from localStorage:', storedPostObject);\n    setPostObject(JSON.parse(storedPostObject));\n  }\n  const handleUploadComplete = async () => {\n    var _postObject$title, _postObject$content, _String, _String2;\n    const formData = new FormData();\n    formData.append('title', (_postObject$title = postObject.title) !== null && _postObject$title !== void 0 ? _postObject$title : '');\n    if (postObject.price != null) {\n      formData.append('price', String(postObject.price));\n    }\n    formData.append('content', (_postObject$content = postObject.content) !== null && _postObject$content !== void 0 ? _postObject$content : '');\n    formData.append('categoryId', (_String = String(postObject.categoryId)) !== null && _String !== void 0 ? _String : '');\n    formData.append('locationId', (_String2 = String(postObject.locationId)) !== null && _String2 !== void 0 ? _String2 : '');\n    if (postObject.files) {\n      for (const fileItem of postObject.files) {\n        const fileData = JSON.parse(fileItem); // JSON 문자열을 객체로 변환\n        const {\n          imageUrl,\n          fileName,\n          fileSize\n        } = fileData;\n\n        // imageUrl을 Blob으로 변환\n        const response = await fetch(imageUrl);\n        const blob = await response.blob();\n        const file = new File([blob], fileName, {\n          type: blob.type,\n          lastModified: fileSize\n        });\n\n        // formData에 파일 추가\n        formData.append('productImageUrls', file);\n      }\n    }\n    await postProducts(formData, accessToken);\n    localStorage.removeItem('postObject');\n    navigation(-1);\n  };\n  const isAllValuesNotNullExceptPrice = postObject => {\n    const {\n      price,\n      ...rest\n    } = postObject;\n    return Object.values(rest).every(value => value !== null);\n  };\n  const handleBackIconClick = () => {\n    localStorage.removeItem('postObject');\n    navigation(-1);\n  };\n  useEffect(() => {\n    const postObjectToStore = {\n      ...postObject\n    };\n    localStorage.setItem('postObject', JSON.stringify(postObjectToStore));\n    console.log('Saved postObject to localStorage:', postObjectToStore);\n  }, [postObject]);\n  useEffect(() => {\n    const isCompleteEnabled = isAllValuesNotNullExceptPrice(postObject);\n    setIsUploadCompleteEnabled(isCompleteEnabled);\n  }, [postObject]);\n  console.log(postObject);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(postSalesItemContext.Provider, {\n      value: {\n        postObject,\n        setPostObject\n      },\n      children: [/*#__PURE__*/_jsxDEV(S.Main, {\n        children: [/*#__PURE__*/_jsxDEV(NavBarTitle, {\n          prevTitle: \"\\uB2EB\\uAE30\",\n          type: \"high\",\n          preTitleClick: handleBackIconClick,\n          rightTitleClick: isUploadCompleteEnabled ? handleUploadComplete : undefined,\n          centerTitle: \"\\uB0B4 \\uBB3C\\uAC74 \\uD314\\uAE30\",\n          rightTitle: \"\\uC644\\uB8CC\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(UploadPhoto, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(UploadTitle, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(UploadPrice, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(UploadComment, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(UploadLocation, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n};\n_s(SalesMyItemPage, \"MmSnGH53dj+0o75Ify8ojdSymjM=\", false, function () {\n  return [useNavigate];\n});\n_c = SalesMyItemPage;\nexport default SalesMyItemPage;\nvar _c;\n$RefreshReg$(_c, \"SalesMyItemPage\");","map":{"version":3,"names":["useNavigate","useEffect","useState","postProducts","ACCESS_TOKEN","postSalesItemContext","S","NavBarTitle","UploadPhoto","UploadTitle","UploadPrice","UploadComment","UploadLocation","jsxDEV","_jsxDEV","Fragment","_Fragment","SalesMyItemPage","_s","accessToken","localStorage","getItem","navigation","initialPostObject","title","price","content","categoryId","locationId","files","postObject","setPostObject","isUploadCompleteEnabled","setIsUploadCompleteEnabled","storedPostObject","JSON","stringify","console","log","parse","handleUploadComplete","_postObject$title","_postObject$content","_String","_String2","formData","FormData","append","String","fileItem","fileData","imageUrl","fileName","fileSize","response","fetch","blob","file","File","type","lastModified","removeItem","isAllValuesNotNullExceptPrice","rest","Object","values","every","value","handleBackIconClick","postObjectToStore","setItem","isCompleteEnabled","children","Provider","Main","prevTitle","preTitleClick","rightTitleClick","undefined","centerTitle","rightTitle","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/sarang_daddy/Documents/second-hand/frontend/src/pages/SalesMyItem/index.tsx"],"sourcesContent":["import { useNavigate } from 'react-router-dom';\nimport { useEffect, useState } from 'react';\n\nimport { postProducts } from '../../api/product';\nimport { ACCESS_TOKEN } from '../../constants/login';\nimport {\n  postSalesItemContext,\n  PostObjectType,\n} from '../../context/SalesItem/useContext';\n\nimport * as S from './styles';\nimport NavBarTitle from '../../components/NavBarTitle';\nimport UploadPhoto from '../../components/UploadPhoto';\nimport UploadTitle from '../../components/UploadTitle';\nimport UploadPrice from '../../components/UploadPrice';\nimport UploadComment from '../../components/UploadComment';\nimport UploadLocation from '../../components/UploadLocation';\n\nconst SalesMyItemPage = () => {\n  const accessToken = localStorage.getItem(ACCESS_TOKEN);\n  const navigation = useNavigate();\n\n  const initialPostObject: PostObjectType = {\n    title: null,\n    price: null,\n    content: null,\n    categoryId: null,\n    locationId: null,\n    files: null,\n  };\n\n  const [postObject, setPostObject] =\n    useState<PostObjectType>(initialPostObject);\n  const [isUploadCompleteEnabled, setIsUploadCompleteEnabled] = useState(false);\n\n  const storedPostObject = localStorage.getItem('postObject');\n  if (storedPostObject && storedPostObject !== JSON.stringify(postObject)) {\n    console.log('Loaded postObject from localStorage:', storedPostObject);\n    setPostObject(JSON.parse(storedPostObject));\n  }\n\n  const handleUploadComplete = async () => {\n    const formData = new FormData();\n\n    formData.append('title', postObject.title ?? '');\n    if (postObject.price != null) {\n      formData.append('price', String(postObject.price));\n    }\n    formData.append('content', postObject.content ?? '');\n    formData.append('categoryId', String(postObject.categoryId) ?? '');\n    formData.append('locationId', String(postObject.locationId) ?? '');\n\n    if (postObject.files) {\n      for (const fileItem of postObject.files) {\n        const fileData = JSON.parse(fileItem); // JSON 문자열을 객체로 변환\n        const { imageUrl, fileName, fileSize } = fileData;\n\n        // imageUrl을 Blob으로 변환\n        const response = await fetch(imageUrl);\n        const blob = await response.blob();\n        const file = new File([blob], fileName, {\n          type: blob.type,\n          lastModified: fileSize,\n        });\n\n        // formData에 파일 추가\n        formData.append('productImageUrls', file);\n      }\n    }\n\n    await postProducts(formData, accessToken);\n    localStorage.removeItem('postObject');\n    navigation(-1);\n  };\n\n  const isAllValuesNotNullExceptPrice = (postObject: PostObjectType) => {\n    const { price, ...rest } = postObject;\n    return Object.values(rest).every((value) => value !== null);\n  };\n\n  const handleBackIconClick = () => {\n    localStorage.removeItem('postObject');\n    navigation(-1);\n  };\n\n  useEffect(() => {\n    const postObjectToStore = { ...postObject };\n    localStorage.setItem('postObject', JSON.stringify(postObjectToStore));\n    console.log('Saved postObject to localStorage:', postObjectToStore);\n  }, [postObject]);\n\n  useEffect(() => {\n    const isCompleteEnabled = isAllValuesNotNullExceptPrice(postObject);\n    setIsUploadCompleteEnabled(isCompleteEnabled);\n  }, [postObject]);\n\n  console.log(postObject);\n\n  return (\n    <>\n      <postSalesItemContext.Provider value={{ postObject, setPostObject }}>\n        <S.Main>\n          <NavBarTitle\n            prevTitle=\"닫기\"\n            type=\"high\"\n            preTitleClick={handleBackIconClick}\n            rightTitleClick={\n              isUploadCompleteEnabled ? handleUploadComplete : undefined\n            }\n            centerTitle=\"내 물건 팔기\"\n            rightTitle=\"완료\"\n          />\n          <UploadPhoto />\n          <UploadTitle />\n          <UploadPrice />\n          <UploadComment />\n        </S.Main>\n        <UploadLocation />\n      </postSalesItemContext.Provider>\n    </>\n  );\n};\n\nexport default SalesMyItemPage;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}