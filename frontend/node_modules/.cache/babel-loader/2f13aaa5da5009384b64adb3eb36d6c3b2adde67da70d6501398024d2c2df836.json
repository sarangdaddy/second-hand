{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useReducer, useEffect, useState } from 'react';\nfunction reducer(state, action) {\n  switch (action.type) {\n    case 'LOADING':\n      return {\n        isLoading: true,\n        data: null,\n        error: null\n      };\n    case 'SUCCESS':\n      return {\n        isLoading: false,\n        data: action.data,\n        error: null\n      };\n    case 'ERROR':\n      return {\n        isLoading: false,\n        data: null,\n        error: action.error\n      };\n    default:\n      return state;\n  }\n}\nfunction useAsync(callback, deps = [], skip = false) {\n  _s();\n  const initialState = {\n    isLoading: false,\n    data: null,\n    error: null\n  };\n  const [state, dispatch] = useReducer(reducer, initialState);\n  const fetchData = async () => {\n    dispatch({\n      type: 'LOADING'\n    });\n    try {\n      const response = await callback();\n      dispatch({\n        type: 'SUCCESS',\n        data: response.data\n      });\n    } catch (e) {\n      dispatch({\n        type: 'ERROR',\n        error: e\n      });\n    }\n  };\n  const [ignore, setIgnore] = useState(false);\n  useEffect(() => {\n    if (skip) return;\n    console.log('mount', ignore);\n    if (!ignore) {\n      fetchData();\n    }\n    return () => {\n      setIgnore(true);\n      console.log('mount', ignore);\n    };\n  }, deps);\n  const {\n    isLoading,\n    data,\n    error\n  } = state;\n  return {\n    isLoading,\n    data: data,\n    error,\n    refetch: fetchData\n  };\n}\n_s(useAsync, \"Wq3MVxH0PUki04ypI5j3nZKpKQk=\");\nexport default useAsync;","map":{"version":3,"names":["useReducer","useEffect","useState","reducer","state","action","type","isLoading","data","error","useAsync","callback","deps","skip","_s","initialState","dispatch","fetchData","response","e","ignore","setIgnore","console","log","refetch"],"sources":["/Users/sarang_daddy/Documents/second-hand/frontend/src/hooks/useAsync.ts"],"sourcesContent":["import { useReducer, useEffect, DependencyList, useState } from 'react';\nimport { AxiosResponse, AxiosError } from 'axios';\n\ninterface State<T> {\n  isLoading: boolean;\n  data: T | null;\n  error: AxiosError | null;\n}\n\ntype Action<T> =\n  | { type: 'LOADING' }\n  | { type: 'SUCCESS'; data: T }\n  | { type: 'ERROR'; error: AxiosError };\n\nfunction reducer<T>(state: State<T>, action: Action<T>): State<T> {\n  switch (action.type) {\n    case 'LOADING':\n      return {\n        isLoading: true,\n        data: null,\n        error: null,\n      };\n    case 'SUCCESS':\n      return {\n        isLoading: false,\n        data: action.data,\n        error: null,\n      };\n    case 'ERROR':\n      return {\n        isLoading: false,\n        data: null,\n        error: action.error,\n      };\n    default:\n      return state;\n  }\n}\n\nfunction useAsync<T>(\n  callback: () => Promise<AxiosResponse<T>>,\n  deps: DependencyList = [],\n  skip = false,\n): {\n  isLoading: boolean;\n  data: T | null;\n  error: AxiosError | null;\n  refetch: () => Promise<void>;\n} {\n  const initialState: State<T> = {\n    isLoading: false,\n    data: null,\n    error: null,\n  };\n\n  const [state, dispatch] = useReducer(reducer, initialState);\n\n  const fetchData = async (): Promise<void> => {\n    dispatch({ type: 'LOADING' });\n    try {\n      const response: AxiosResponse<T> = await callback();\n      dispatch({ type: 'SUCCESS', data: response.data });\n    } catch (e) {\n      dispatch({ type: 'ERROR', error: e as AxiosError });\n    }\n  };\n\n  const [ignore, setIgnore] = useState(false);\n\n  useEffect(() => {\n    if (skip) return;\n\n    console.log('mount', ignore);\n    if (!ignore) {\n      fetchData();\n    }\n    return () => {\n      setIgnore(true);\n      console.log('mount', ignore);\n    };\n  }, deps);\n\n  const { isLoading, data, error } = state;\n\n  return { isLoading, data: data as T, error, refetch: fetchData };\n}\n\nexport default useAsync;\n"],"mappings":";AAAA,SAASA,UAAU,EAAEC,SAAS,EAAkBC,QAAQ,QAAQ,OAAO;AAcvE,SAASC,OAAOA,CAAIC,KAAe,EAAEC,MAAiB,EAAY;EAChE,QAAQA,MAAM,CAACC,IAAI;IACjB,KAAK,SAAS;MACZ,OAAO;QACLC,SAAS,EAAE,IAAI;QACfC,IAAI,EAAE,IAAI;QACVC,KAAK,EAAE;MACT,CAAC;IACH,KAAK,SAAS;MACZ,OAAO;QACLF,SAAS,EAAE,KAAK;QAChBC,IAAI,EAAEH,MAAM,CAACG,IAAI;QACjBC,KAAK,EAAE;MACT,CAAC;IACH,KAAK,OAAO;MACV,OAAO;QACLF,SAAS,EAAE,KAAK;QAChBC,IAAI,EAAE,IAAI;QACVC,KAAK,EAAEJ,MAAM,CAACI;MAChB,CAAC;IACH;MACE,OAAOL,KAAK;EAChB;AACF;AAEA,SAASM,QAAQA,CACfC,QAAyC,EACzCC,IAAoB,GAAG,EAAE,EACzBC,IAAI,GAAG,KAAK,EAMZ;EAAAC,EAAA;EACA,MAAMC,YAAsB,GAAG;IAC7BR,SAAS,EAAE,KAAK;IAChBC,IAAI,EAAE,IAAI;IACVC,KAAK,EAAE;EACT,CAAC;EAED,MAAM,CAACL,KAAK,EAAEY,QAAQ,CAAC,GAAGhB,UAAU,CAACG,OAAO,EAAEY,YAAY,CAAC;EAE3D,MAAME,SAAS,GAAG,MAAAA,CAAA,KAA2B;IAC3CD,QAAQ,CAAC;MAAEV,IAAI,EAAE;IAAU,CAAC,CAAC;IAC7B,IAAI;MACF,MAAMY,QAA0B,GAAG,MAAMP,QAAQ,CAAC,CAAC;MACnDK,QAAQ,CAAC;QAAEV,IAAI,EAAE,SAAS;QAAEE,IAAI,EAAEU,QAAQ,CAACV;MAAK,CAAC,CAAC;IACpD,CAAC,CAAC,OAAOW,CAAC,EAAE;MACVH,QAAQ,CAAC;QAAEV,IAAI,EAAE,OAAO;QAAEG,KAAK,EAAEU;MAAgB,CAAC,CAAC;IACrD;EACF,CAAC;EAED,MAAM,CAACC,MAAM,EAAEC,SAAS,CAAC,GAAGnB,QAAQ,CAAC,KAAK,CAAC;EAE3CD,SAAS,CAAC,MAAM;IACd,IAAIY,IAAI,EAAE;IAEVS,OAAO,CAACC,GAAG,CAAC,OAAO,EAAEH,MAAM,CAAC;IAC5B,IAAI,CAACA,MAAM,EAAE;MACXH,SAAS,CAAC,CAAC;IACb;IACA,OAAO,MAAM;MACXI,SAAS,CAAC,IAAI,CAAC;MACfC,OAAO,CAACC,GAAG,CAAC,OAAO,EAAEH,MAAM,CAAC;IAC9B,CAAC;EACH,CAAC,EAAER,IAAI,CAAC;EAER,MAAM;IAAEL,SAAS;IAAEC,IAAI;IAAEC;EAAM,CAAC,GAAGL,KAAK;EAExC,OAAO;IAAEG,SAAS;IAAEC,IAAI,EAAEA,IAAS;IAAEC,KAAK;IAAEe,OAAO,EAAEP;EAAU,CAAC;AAClE;AAACH,EAAA,CA9CQJ,QAAQ;AAgDjB,eAAeA,QAAQ"},"metadata":{},"sourceType":"module","externalDependencies":[]}